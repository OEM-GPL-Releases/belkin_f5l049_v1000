<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<j mmtype>
<title>hide</title>
<script type="text/javascript">
<!--

var menuid = "";
var specifying = -1;

function make_item()
{
	if (top.contents.main.standalone && top.contents.main.standalone != 0) return;
	n = 0;
	if (top.contents.main.targetIndex) n = top.contents.main.targetIndex;

	with(document) {
		if(menuid != top.contents.menuid) {
			clean();
		}
		target_form = top.contents.main.document.forms[n];
		item_num = target_form.elements.length;
		data_stock = document.forms[0];
		var max = data_stock.elements.length;
		for(i=0; i<item_num; i++) {
			var flag = 0;
			for(j=0; j<max; j++) {
				if (target_form.elements[i].name == data_stock.elements[j].name) {
					flag = 1;
					break;
				}
			}
			if (flag) continue;
			if (target_form.elements[i].type) {
				if (target_form.elements[i].type == "select-one") {
					var oChi = createElement('select');
					oChi.name = target_form.elements[i].name;
					data_stock.appendChild(oChi);
					for(j=0; j<target_form.elements[i].options.length; j++) {
						var oOpt = createElement('option');
						if(oChi.childNodes[j]  != undefined)
							oChi.removeChild(oChi.childNodes[j]);
						oChi.appendChild(oOpt);

						oChi.childNodes[j].setAttribute('value',target_form.elements[i].options[j].value);
						oAddx= document.createTextNode(target_form.elements[i].options[j].value);
						if(oChi.childNodes[j].firstChild  != undefined)
							oChi.childNodes[j].removeChild(oChi.childNodes[j].firstChild);

						oChi.childNodes[j].appendChild(oAddx);

						if (target_form.elements[i].selectedIndex == j) {
							oChi.selectedIndex = j;
						}
					}
					oChi.length = j;
					continue;
				}
				else if (target_form.elements[i].type == "textarea") {
					var oChi = createElement('textarea');
				}
				else if ((target_form.elements[i].type == "button") ||
				         (target_form.elements[i].type == "submit") ||
				         (target_form.elements[i].type == "reset")) {
					continue;
				}
				else if (target_form.elements[i].type == "file") {
					continue;
				}
				else {
					var oChi = createElement('input');
				}
			}
			if (oChi.type != "textarea") {
				oChi.type = target_form.elements[i].type;
			}
			oChi.name = target_form.elements[i].name;
			oChi.value = target_form.elements[i].value;
			data_stock.appendChild(oChi);
			if ((oChi.type == "radio") || (oChi.type == "checkbox")) {
				oChi.checked = target_form.elements[i].checked;
			}
		}
	}
}
function clean()
{
	with(document) {
		data_stock = document.forms[0];
		while((max = data_stock.elements.length) != 0) {
			for(i=0; i<max; i++) {
				var oChi = data_stock.childNodes[0];
				data_stock.removeChild(oChi);
			}
		}
	}
	menuid = top.contents.menuid;
}

function Callback()
{
	if (top.contents.main.standalone && top.contents.main.standalone != 0) return;
	n = 0;
	if (top.contents.main.targetIndex) n = top.contents.main.targetIndex;

	target_form = top.contents.main.document.forms[n];
	item_num = target_form.elements.length;
	data_stock = document.forms[0];

	make_item();
	datastock_index = 0;
	for (i = 0; i < item_num; i++) {
		cur_name = target_form.elements[i].name

		if (cur_name=="NONE") {
			if (specifying != -1) {
				target_form.elements[i].options[specifying].selected = true;
			}
			specifying = target_form.elements[i].selectedIndex;
			continue;
		}

		mode = 0

		if ( target_form.elements[i].type ){
			if (target_form.elements[i].type =="select-one") mode = 1
		}
		else {
			if (target_form.elements[i].options ) mode = 1
		}
		if (target_form.elements[i].type) {
			if (target_form.elements[i].type == "checkbox") mode = 2
			if (target_form.elements[i].type == "radio")    mode = 2
		}
		if ((target_form.elements[i].type == "button") ||
		    (target_form.elements[i].type == "submit") ||
		    (target_form.elements[i].type == "reset")) {
			continue;
		}
		if (target_form.elements[i].type == "file") {
			continue;
		}

		j = datastock_index;
		if (data_stock.elements[j].name != cur_name) {
			for(j = 0; j < data_stock.elements.length; j++) {
				if (data_stock.elements[j].name == cur_name) {
					datastock_index = j;
					break;
				}
			}
			if (j == data_stock.elements.length) continue;
		}

		if (mode == 1) {
			target_form.elements[i].options[data_stock.elements[j].selectedIndex].selected = true
		}
		else if (mode == 2) {
			if (data_stock.elements[j].checked == true) {
				target_form.elements[i].checked = true
			}
			else {
				target_form.elements[i].checked = false
			}
		}
		else {
			if (cur_name=="<j ctx_name:VARID_DOT11_WEP_KEY0>" ||
			    cur_name=="<j ctx_name:VARID_DOT11_WEP_KEY1>" ||
			    cur_name=="<j ctx_name:VARID_DOT11_WEP_KEY2>" ||
			    cur_name=="<j ctx_name:VARID_DOT11_WEP_KEY3>") {
				if (specifying == 0) target_form.elements[i].value = top.contents.main.ASCII_HEX(data_stock.elements[j], 0, 2);
				else target_form.elements[i].value = top.contents.main.ASCII_HEX(data_stock.elements[j], 2, 2);
			}
			else {
				target_form.elements[i].value = data_stock.elements[j].value
			}
		}
		datastock_index++;
	}
	return true;
}

function UpdateFromSlave()
{
	if (top.contents.main.standalone && top.contents.main.standalone != 0) return;
	n = 0;
	if (top.contents.main.targetIndex) n = top.contents.main.targetIndex;

	if (top.contents.main.document.forms.length == 0) return true;
	target_form = top.contents.main.document.forms[n];
	item_num = target_form.elements.length;
	data_stock = document.forms[0];

	make_item();
	datastock_index = 0;
	for (i = 0; i < item_num; i++) {
		cur_name = target_form.elements[i].name

		if (cur_name=="NONE") {
			specifying = target_form.elements[i].selectedIndex;
			continue;
		}

		mode = 0

		if (target_form.elements[i].type){
			if (target_form.elements[i].type =="select-one") mode = 1
		}
		else {
			if (target_form.elements[i].options ) mode = 1
		}
		if (target_form.elements[i].type) {
			if (target_form.elements[i].type == "checkbox") mode = 2
			if (target_form.elements[i].type == "radio")    mode = 2
		}
		if ((target_form.elements[i].type == "button") ||
		    (target_form.elements[i].type == "submit") ||
		    (target_form.elements[i].type == "reset")) {
			continue;
		}
		if (target_form.elements[i].type == "file") {
			continue;
		}

		j = datastock_index;
		if (data_stock.elements[j].name != cur_name) {
			for(j = 0; j < data_stock.elements.length; j++) {
				if (data_stock.elements[j].name == cur_name) {
					datastock_index = j;
					break;
				}
			}
			if (j == data_stock.elements.length) continue;
		}

		if (mode == 1){
			data_stock.elements[j].options[target_form.elements[i].selectedIndex].selected = true;
		}
		else if (mode == 2) {
			if (target_form.elements[i].checked == true) {
				data_stock.elements[j].checked	=	true
			}
			else {
				data_stock.elements[j].checked	=	false
			}
		}
		else {
			if (cur_name=="<j ctx_name:VARID_DOT11_WEP_KEY0>" ||
			    cur_name=="<j ctx_name:VARID_DOT11_WEP_KEY1>" ||
			    cur_name=="<j ctx_name:VARID_DOT11_WEP_KEY2>" ||
			    cur_name=="<j ctx_name:VARID_DOT11_WEP_KEY3>") {
				if (specifying == 0) data_stock.elements[j].value = top.contents.main.ASCII_HEX(target_form.elements[i], 1, 1);
				else data_stock.elements[j].value = top.contents.main.ASCII_HEX(target_form.elements[i], 2, 1);
				continue;
			}
			else {
				data_stock.elements[j].value	=	target_form.elements[i].value
			}
		}
		datastock_index++;
	}
	return true;
}

function DoSubmit()
{
	n = 0;
	if (top.contents.main.targetIndex) n = top.contents.main.targetIndex;

	if (top.contents.main.standalone && top.contents.main.standalone != 0) {
		top.contents.main.document.forms[n].submit();
		return true;
	}
	if (UpdateFromSlave()) {
		top.hide.document.forms[0].submit();
		return true;
	}
	return false
}
//-->
</script>
</head>
<body>
<form action="/<j dir_path>/private/conf/result_main.htm" method="post" target="main">
</form>
</body>
</html>
